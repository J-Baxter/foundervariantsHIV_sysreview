# Inferring the multiplicity of founder variant initiating HIV-1 infection: a systematic review and meta-analysis

This repository contains the code and data associated with the above manuscript.

## Data
All the required data to run the code is available in the data.zip file. It is not necessary to decompress this file manually as this is done automatically using the Retrieve function in generalpurpose_funcs.R

## Scripts
All scripts marked binary refer to the calculation of the proportion of infections initiated by multiple variants (ie single vs multiple founders), rather than the number of variants that initiated infection. Analysis of the number of variants initiating infection was discontinued due to difficulties in fitting a suitable model to the data.  

On opening the project for the first time, .Rprofile will run (and install if necessary) the required packages for the analysis. It will also create results and figures directory labelled with the system
date. NB accessing the results to create the figures will require modifying the figures scripts to access the correct directory.


binary_pooling.R, binary_univarmetareg.R and binary_metareg.R encode the analyses for pooling, univariable meta-analysis and multivariable meta-analysis respectively. Each script contains the respective sensitivity analyses. **Some of these sensitivity analyses require hours to run as we are resampling and recalculating the models a thousand times** Additional sensitivity analyses as requested during review are available in the binary_seqtech.R and binary_vccinestatus.R scripts.

Postprocessing may be required in order to retrieve the plots generated by binary_poolng_vis.R and binary_metareg_vis.R. Exporting figures in eps format on specific system dependencies may require additional setup not specified in this repo.